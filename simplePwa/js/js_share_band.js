(function(h){function k(a){this.params=a;this.service={schemeUrl:"bandapp://create/post",installUrlForIos:"itms-apps://itunes.apple.com/app/id542613198",installUrlForAndroid:"market://details?id=com.nhn.android.band",packageNameForAndroid:"com.nhn.android.band",webUrlForNotSupported:"http://www.band.us"};this.platform={ios:!1,android:!1,androidChromeIntent:!1,notSupported:!1};this.configure=function(){if(navigator.userAgent.match(/iPhone|iPad|iPod/i))this.platform.ios=!0;else if(navigator.userAgent.match(/Android/i)){this.platform.android=
!0;var a=navigator.userAgent.match(/Chrome\/[0-9]*/g);a&&25<=a[0].split("/")[1]&&(this.platform.androidChromeIntent=!0)}else this.platform.notSupported=!0;this.service.schemeUrl=this.service.schemeUrl+"?text="+this.params.text+"&route="+this.params.route;return this};this.launchApp=function(){if(this.platform.ios){var a=(new Date).getTime(),b=setTimeout(function(){3E3>(new Date).getTime()-a&&(window.location.href=this.service.installUrlForIos)},2E3);window.addEventListener("pagehide",function(a){return function(){clearTimeout(a);
window.removeEventListener("pagehide",arguments.callee)}}(b));window.location.href=this.service.schemeUrl}else if(this.platform.android){var a=(new Date).getTime(),d=!1;this.platform.androidChromeIntent&&""!=this.service.packageNameForAndroid?window.location.href="intent:"+this.service.schemeUrl+"#Intent;package="+this.service.packageNameForAndroid+";end;":(b=document.createElement("iframe"),b.style.display="none",b.src=this.service.schemeUrl,setTimeout(function(){2E3>(new Date).getTime()-a&&!d&&
(d=!0,window.location=this.service.installUrlForAndroid)},500),b.onload=function(){d||(d=!0,window.location=this.service.installUrlForAndroid)},document.body.appendChild(b),document.body.removeChild(b))}else""!=this.service.webUrlForNotSupported&&(window.location.href=this.service.webUrlForNotSupported)}}if(function(a){a=a.split(".");for(var c=h;0<a.length;){var b=a.pop();"undefined"===typeof c[b]&&(c[b]={});if("object"!==typeof c[b])return null;c=c[b]}return c}("ShareBand")){var e={bind:function(a,
c,b){a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent("on"+c,b)},getThisScriptElement:function(){var a=document.getElementsByTagName("script");return a[a.length-1]},each:function(a,c){for(var b=0,d=a.length;b<d&&!1!==c(b,a[b],a);b++);},attr:function(a,c){for(var b in c)a.setAttribute(b,c[b])},map:function(a,c){var b=[];e.each(a,function(a,e,g){b.push(c(a,e,g))});return b},filter:function(a,c){var b=[];e.each(a,function(a,e,g){c(a,e,g)&&b.push(e)});return b},ready:function(a){e.bind(window,
"load",a)},isSmartphone:function(){return navigator.userAgent.match(/(iPhone|iPod|iPad|Android)/i)},json2str:function(a){var c=[],b;for(b in a){var d=a[b];if(d)var e="number"==typeof d||"boolean"==typeof d?d:'"'+d+'"';c.push('"'+b.toString()+'": '+e)}return"{"+c.join(", ")+"}"},agentType:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)?"ios":navigator.userAgent.match(/Android/i)?"android":"web"}},l=function(){return{send:function(a,c){var b=c.callbackName||"callback",d=c.onSuccess||
function(){},e=c.onTimeout||function(){},g=window.setTimeout(function(){window[b]=function(){};e()},1E3*(c.timeout||10));window[b]=function(a){window.clearTimeout(g);d(a)};var f=document.createElement("script");f.type="text/javascript";f.async=!0;f.src=a;document.getElementsByTagName("head")[0].appendChild(f)}}}(),f={constant:{IMG_BASE_URL:location.href.replace("http://","").replace("https://","").match(/^([a-z0-9-_\.]*)[\/](comm)[\/]([a-z0-9-_]*)[\/]/i)[0]+"images/",ALT:{ko:"\ubc34\ub4dc\uacf5\uc720",
en:"Share on BAND"},IMG_SIZE:{ko:{a:[72,22],b:[58,83],c:[30,30],d:[40,40],e:[41,58],f:[81,24]},en:{a:[68,22],b:[58,83],c:[30,30],d:[40,40],e:[42,60],f:[79,24]}},STAT_URL:"statcatcher.band.us/log/write_log",PHASE:"",STAT_PHASE:""},phase:function(a,c){this.constant.PHASE=void 0==a?"":a;this.constant.STAT_PHASE=void 0==c?this.constant.PHASE:c;return this},properties:function(){return{img_base_url:"//"+this.constant.PHASE+(""===this.constant.PHASE?"":"-")+this.constant.IMG_BASE_URL,stat_url:"//"+this.constant.STAT_PHASE+
(""===this.constant.STAT_PHASE?"":"-")+this.constant.STAT_URL}},insertButton:function(a,c,b){a=this.validate(a);b=b.parentNode===c?b:void 0;a=this.createTag(a);c.insertBefore(a,b);return a},validate:function(a){var c={lang:/^(ko|en)$/,type:/^(a|b|c|d|e|f)$/,text:/^[\s\S]+$/},b={lang:"ko",type:"a",text:null};if(!a)return b;for(var d in b)a[d]&&"string"===typeof a[d]&&a[d].match(c[d])&&(b[d]=a[d]);b.withUrl=!!a.withUrl;return b},createTag:function(a){var c=this.constant.IMG_SIZE[a.lang][a.type],b=document.createElement("a");
e.attr(b,{href:"javascript:;"});var d=document.createElement("img");e.attr(d,{src:this.createImageUrl(a),width:c[0],height:c[1],alt:this.constant.ALT[a.lang]});b.appendChild(d);return b},text:function(a){var c;a.text?(c=[a.text],a.withUrl&&c.push(document.location.href)):c=[document.title,document.location.href];return c.join("\n")},createImageUrl:function(a){a=this.constant.IMG_SIZE[a.lang][a.type];return[this.properties().img_base_url,a[0],"x",a[1],".png"].join("")},sendLog:function(a){a={log_type:"CLICK",
code:1,route:a.route,agent:e.agentType()};try{l.send(this.properties().stat_url+"?callback=callback&jsonLog="+encodeURIComponent(e.json2str(a)),{callbackName:"callback",onSuccess:function(a){},onTimeout:function(){},timeout:2})}catch(c){}},handleEvent:function(a){a=this.text(a);a={text:encodeURIComponent(a).replace(/\+/g,"%20"),route:document.location.hostname};this.sendLog(a);e.isSmartphone()?(new k(a)).configure().launchApp():window.open("http://www.band.us/plugin/share?body="+a.text+"&route="+
a.route,"share_band","width=410, height=540, resizable=no");return!1}};h.ShareBand.makeButton=function(a,c,b){var d=e.getThisScriptElement(),h=d.parentNode;"head"!==h.tagName.toLowerCase()&&e.ready(function(){var g=f.phase(c,b).insertButton(a,h,d);e.bind(g,"click",function(){f.handleEvent(a);return!1})})};h.ShareBand.Button=function(a,c){this.imageUrl=function(){var b=f.phase(c).validate(a);return f.createImageUrl(b)};this.bind=function(b,d){e.bind(b,d,function(){f.phase(c).handleEvent(a);return!1})}}}})(this);